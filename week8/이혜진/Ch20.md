# Ch20 회귀분석과 유의성 검정

* 개별 계수 추정량의 표준오차
    * 회귀계수 추정량의 표준오차
    * 기울기와 절편 추정량의 표준오차
* 개별 계수에 대한 추론
* 개별값 예측과 평균값 예측
* Yellowstone Geyser “Old Faithful”
* 회귀 잔차를 이용한 런검정
    * 런검정
* 런검정의 응용

<br>

---

# 1. 개별 계수 추정량의 표준오차

## 회귀계수 추정량의 표준오차

![1](https://user-images.githubusercontent.com/40786985/76537831-aea90680-64c1-11ea-99ac-eb5bfb01e8b9.jpg)

* 왼쪽, 오른쪽 scatter plot의 점들 변화 `(sampling uncertainty)`

* A가 1000명 뽑아서 X, Y 관계 연구 → B가 1000명 뽑아서 연구 → ... → R번째 연구자가 1000명 뽑아서 연구 (데이터 다 다름)
* 데이터가 달라지면 그 scatter plot의 점들을 요약하는 직선도 달라지고, 절편과 기울기도 달라짐
* 한 연구에서 다른 연구로 넘어갈 때 한 세트 연구에 담긴 절편 추정량의 불확실성이 어느 정도인지가 `기울기 추정량의 표준오차`
* C가 연구를 다시 한다고 하면 절편과 기울기가 어느 정도 변하는 지가 `표준오차`
* 그때 그때 어느 정도 달라지는지 알면, 그것의 2배를 내가 얻은 값에서 buffer로 안전장치 둘 수 있음 `(신뢰구간)`
    * 포인트 X, 구간에 신뢰 부여 가능

<br>

### 기울기와 절편 추정량의 표준오차

![2](https://user-images.githubusercontent.com/40786985/76537835-afda3380-64c1-11ea-814e-24bc7a0e2d61.jpg)

* **시그마 햇**
    * 시그마 데이터로부터 추정한 값
    * `RMSE`
    * scatter plot 상에 점 하나가 regression line으로부터 평균적으로 얼마나 떨어져 있는가
    * 크면 클수록 절편과 기울기에 담긴 불확실성 大
        * 데이터가 위아래로 퍼져 있으니까 절편과 기울기도 그렇게 커지는 것
    * 방향은 직관적으로 해석 가능
        * 샘플 사이즈↑ → 절편의 불확실성↓
            * Xi(X의 총변동)이 크면 기울기에 담긴 불확실성도 작아지고 절편에 담긴 불확실성도 작아짐
            * X bar(X의 평균적인 위치)가 y축(0) 근처면 절편 추정하기 쉬움
* **시그마**
    * 데이터 하나하나에 들어 있는 불확실성
    * regression line에서 관측치 하나하나가 얼마나 떨어져 있는가
    * 시그마가 클수록 연구가 반복될 때마다 데이터가 위아래로 변동할 가능성 大
        * 절편, 기울기 구하기 어려움
        * 절편 추정치와 기울기 추정치에 담긴 표준오차↑
    
* **x값의 범위가 좁으면, 데이터가 바뀌는 대로 기울기가 크게 바뀐다.**
* **x값이 널리 퍼져 있으면, 데이터가 조금 바뀐다고 해서 기울기가 크게 변하지 않는다.**

<br>

---

# 2. 개별 계수에 대한 추론

* **단순회귀분석 결과 보고**
    ![3](https://user-images.githubusercontent.com/40786985/76537836-b072ca00-64c1-11ea-8920-d0492b839a66.jpg)
    * 회귀분석 결과를 요약해 주는 기본적인 포맷

<br>

* **기울기에 대한 추론**
![4](https://user-images.githubusercontent.com/40786985/76537840-b072ca00-64c1-11ea-963e-5333b82dca7d.jpg)

<br>

---

# 3. 개별값 예측과 평균값 예측

* 개별값을 예측하기가 평균값을 예측하기보다 더 어렵다.

![5](https://user-images.githubusercontent.com/40786985/76538311-75bd6180-64c2-11ea-841d-69ca482a8203.jpg)

* 개별값 예측할 때 표준오차에는 `1` 포함
    * `1` 때문에 개별값 예측할 때 예측오차 ↑
* 공식 유도 (강의 참고)

<br>

* 개별값 예측의 예측구간과 평균값 예측의 예측구간

![6](https://user-images.githubusercontent.com/40786985/76539139-b1a4f680-64c3-11ea-957d-47c726ca2d57.jpg)


<br>

---

# 4. Yellowstone Geyser “Old Faithful”

* week1-3 그림을 이용한 자료 정리 참고

<br>

---

# 5. 회귀 잔차를 이용한 런검정

* 런과 계열상관
![7](https://user-images.githubusercontent.com/40786985/76539202-caada780-64c3-11ea-9912-0eed4d12ee93.jpg)

<br>

### 런검정

![8](https://user-images.githubusercontent.com/40786985/76539414-16605100-64c4-11ea-8313-e7ad3d065787.jpg)
* \+ 11개, - 9개
* 하나의 런 = 하나의 시퀀스
* 런의 개수는 5개

* 11개의 +와 9개의 -로 이루어진 시퀀스에서 런이 5개 발견되면 양의 계열 상관있다고 봐야 되는가?

* `sampling distribution`
    * 11개의 +와 9개의 - 카드를 상자에 넣는다.
    * 20개의 카드를 무작위 비복원 추출로 뽑는다.
    * 런의 개수를 센다.
    * 10000회 반복
    * 10000개의 런 개수를 오름차순으로 정리하면 500번째 값이 `하한임계치`, 9500번째 값이 `상한임계치`

* 런검정의 하한임계치
    ![9](https://user-images.githubusercontent.com/40786985/76539416-16f8e780-64c4-11ea-9549-914a1233da13.jpg)

* 런검정의 상한임계치
    ![10](https://user-images.githubusercontent.com/40786985/76539804-98507a00-64c4-11ea-91ed-ca51cfe5d4bb.jpg)

<br>

---

# 6. 런검정의 응용

* **응용1**
    ![11](https://user-images.githubusercontent.com/40786985/76539805-9981a700-64c4-11ea-80ef-3bfc6ae94214.jpg)

* **응용2**
    ![12](https://user-images.githubusercontent.com/40786985/76539807-9a1a3d80-64c4-11ea-899b-34677550b630.jpg)

<br>
